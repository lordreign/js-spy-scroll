/* 2016-11-15
author: Jung-sun Park
License: MIT
E-mail:lordreign79@gmail.com
*/
!function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery.ellipsis.min","modernizr-latest"],a):"object"==typeof exports?module.exports=a(require("jquery"),require("jquery.ellipsis.min"),require("modernizr-latest")):a(jQuery)}(function(a){"use strict";function b(b,d){return this._pluginInfo=c,this.defaults={scrollSpeed:300,top:{text:"TOP",enable:!0,topHref:"#header",class:"js-page-navi-top"},lastSectionClass:"jspn-last-section"},this.$element=b,a.extend(!0,this.defaults,d),this.options=this.defaults,this.$window=a(window),this.init()}var c={name:"jsSpyScroll",version:"1.0.0"};b.prototype.init=function(){return this._replaceHTML(),this._event(),this.$element},b.prototype._replaceHTML=function(){var b=this.options.top;if(b.enable){var c=this.$element.find("a").last();c.after('<a class="'+b.class+'" href="'+b.topHref+'">'+b.text+"</a>"),this.options.top.$element=a("."+b.class),this.options.top.$element.hide()}},b.prototype._event=function(){var b=this,c=b.$element.offset().top,d=b.options.top,e=b.$element.height(),f=a(document),g=a("body"),h=b.$element.find("a"),i=h.map(function(){var b=a(this);if(!b.hasClass("js-page-navi-external")){var c=a(a(this).attr("href"));if(c.length)return c}}),j=a("."+this.options.lastSectionClass).attr("id");"undefined"==typeof j&&(j=null),this.$window.scroll(function(){a(this).scrollTop()>=c?(d.enable&&d.$element.show(),b.$element.addClass("fixed"),g.css({"padding-top":e+"px"})):(d.enable&&d.$element.hide(),g.css({"padding-top":"0px"}),b.$element.removeClass("fixed"));var k=a(this).scrollTop()+b.$element.height()+e,l=i.map(function(){if(a(this).offset().top<k)return this});l=d.enable?l[l.length-2]:l[l.length-1];var m=l.attr("id");b.$window.scrollTop()+b.$window.height()===f.height()&&(m=null===j?b.$element.parent().children().last().attr("id"):j),h.removeClass("on").filter('[href="#'+m+'"]').addClass("on")}),b._setButton()},b.prototype._setButton=function(){var b=this,c=a("html, body"),d=b.$element.height();this.$element.find("a").on("click",function(){if(a(this).hasClass("js-page-navi-external"))return!0;var e=a(this).attr("href");c.animate({scrollTop:a(e).offset().top-d},b.options.scrollSpeed)})},a.fn.jsSpyScroll=function(c){return new b(a(this),c)}});